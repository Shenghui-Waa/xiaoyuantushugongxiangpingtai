<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>校园图书共享平台 - 首页</title>
    <!-- 外部资源引入 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Tailwind 核心配置（与分类页完全一致） -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',    // 主色调：靛蓝色
                        secondary: '#10B981',  // 辅助色：绿色（借阅按钮）
                        accent: '#F59E0B',     // 强调色：橙色（热门标签）
                        neutral: '#F3F4F6',    // 中性色：浅灰（背景）
                    },
                    fontFamily: {
                        sans: ['Inter', 'PingFang SC', 'Microsoft YaHei', 'sans-serif'],
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' }
                        },
                        slideInLeft: {
                            '0%': { opacity: '0', transform: 'translateX(-20px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' }
                        },
                        scaleIn: {
                            '0%': { opacity: '0', transform: 'scale(0.95)' },
                            '100%': { opacity: '1', transform: 'scale(1)' }
                        },
                        pulseSoft: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.7' }
                        },
                        hoverPulse: {
                            '0%': { boxShadow: '0 0 0 0 rgba(79, 70, 229, 0.2)' },
                            '70%': { boxShadow: '0 0 0 8px rgba(79, 70, 229, 0)' },
                            '100%': { boxShadow: '0 0 0 0 rgba(79, 70, 229, 0)' }
                        },
                        carouselFade: {
                            '0%': { opacity: '0' },
                            '10%': { opacity: '1' },
                            '90%': { opacity: '1' },
                            '100%': { opacity: '0' }
                        }
                    },
                    animation: {
                        fadeInUp: 'fadeInUp 0.5s ease-out forwards',
                        slideInLeft: 'slideInLeft 0.5s ease-out forwards',
                        scaleIn: 'scaleIn 0.4s ease-out forwards',
                        pulseSoft: 'pulseSoft 2s infinite',
                        hoverPulse: 'hoverPulse 1.5s infinite',
                        carouselFade: 'carouselFade 5s infinite'
                    }
                }
            }
        }
    </script>

    <!-- 自定义工具类（与分类页保持一致） -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1 hover:scale-[1.02];
            }
            .btn-primary {
                @apply bg-primary text-white px-4 py-2 rounded-lg transition-all duration-300 hover:bg-primary/90 hover:shadow-md;
            }
            .btn-secondary {
                @apply bg-secondary text-white px-4 py-2 rounded-lg transition-all duration-300 hover:bg-secondary/90 hover:shadow-md;
            }
            .text-balance {
                text-wrap: balance;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .search-focus {
                @apply focus:border-primary focus:ring-2 focus:ring-primary/30 focus:outline-none transition-all duration-300;
            }
            .back-to-top {
                @apply fixed bottom-6 right-6 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center opacity-0 invisible transition-all duration-300 hover:bg-primary/90 z-40;
            }
            .back-to-top.show {
                @apply opacity-100 visible animate-scaleIn;
            }
            .quick-borrow {
                @apply absolute bottom-3 left-1/2 -translate-x-1/2 bg-secondary text-white text-xs px-3 py-1.5 rounded-lg shadow-md opacity-0 invisible transition-all duration-300 hover:bg-secondary/90;
            }
            .book-card:hover .quick-borrow {
                @apply opacity-100 visible bottom-5 animate-fadeInUp;
            }
            .category-card {
                @apply bg-white rounded-xl p-4 shadow-sm card-hover flex flex-col items-center justify-center text-center;
            }
            .carousel-item {
                @apply absolute inset-0 opacity-0 transition-opacity duration-1000 ease-in-out;
            }
            .carousel-item.active {
                @apply opacity-100;
            }
            /* 新增编辑资料模态框样式 */
            .edit-profile-modal {
                @apply fixed inset-0 z-[60] flex items-center justify-center opacity-0 invisible transition-all duration-300;
            }
            .edit-profile-modal.show {
                @apply opacity-100 visible;
            }
            .modal-content {
                @apply relative bg-white rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto transform scale-95 transition-all duration-300;
            }
            .edit-profile-modal.show .modal-content {
                @apply scale-100;
            }
            .form-group {
                @apply mb-4;
            }
            .form-label {
                @apply block text-sm font-medium text-gray-700 mb-2;
            }
            .form-input {
                @apply w-full px-4 py-2.5 border border-gray-300 rounded-xl focus:border-primary focus:ring-2 focus:ring-primary/30 transition-all duration-300;
            }
            .form-select {
                @apply w-full px-4 py-2.5 border border-gray-300 rounded-xl focus:border-primary focus:ring-2 focus:ring-primary/30 bg-white appearance-none transition-all duration-300;
            }
            .form-textarea {
                @apply w-full px-4 py-2.5 border border-gray-300 rounded-xl focus:border-primary focus:ring-2 focus:ring-primary/30 resize-none transition-all duration-300;
            }
            .checkbox-group {
                @apply flex flex-wrap gap-3;
            }
            .checkbox-label {
                @apply inline-flex items-center px-3 py-2 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-all duration-300;
            }
        }
    </style>
</head>

<body class="bg-neutral font-sans text-gray-800">
<!-- 顶部导航栏（与分类页完全一致） -->
<header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm shadow-sm transition-all duration-300" id="main-header">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between" id="header-content">
        <!-- Logo区域 -->
        <div class="flex items-center space-x-2 animate-fadeInUp" style="animation-delay: 0.1s;">
            <i class="fa fa-book text-primary text-3xl"></i>
            <h1 class="text-xl font-bold text-primary">校园图书共享</h1>
        </div>

        <!-- 桌面端搜索框 -->
        <div class="hidden md:flex items-center flex-1 max-w-xl mx-6 animate-fadeInUp" style="animation-delay: 0.2s;">
            <div class="relative w-full">
                <input type="text" id="search-input" placeholder="搜索书名、作者或ISBN..."
                       class="w-full pl-10 pr-4 py-2 rounded-full border border-gray-200 search-focus"
                       onfocus="this.parentElement.classList.add('w-[110%]')"
                       onblur="this.parentElement.classList.remove('w-[110%]')">
                <i class="fa fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 transition-colors duration-300" id="search-icon"></i>

                <!-- 搜索结果下拉框 -->
                <div id="search-results" class="absolute left-0 right-0 mt-2 bg-white rounded-lg shadow-lg overflow-hidden hidden z-10 max-h-60 overflow-y-auto animate-fadeInUp">
                    <!-- 搜索结果动态生成 -->
                </div>
            </div>
        </div>

        <!-- 导航菜单 -->
        <nav class="flex items-center space-x-2 md:space-x-4 animate-fadeInUp" style="animation-delay: 0.3s;">
            <button class="md:hidden p-2 rounded-full hover:bg-gray-100 transition-colors" id="mobile-search-btn">
                <i class="fa fa-search text-gray-600"></i>
            </button>
            <a href="index.html" class="hidden md:flex items-center px-3 py-2 rounded-lg bg-primary/10 text-primary transition-all duration-300 hover:scale-105">
                <i class="fa fa-home mr-1"></i>首页
            </a>
            <a href="category.html" class="hidden md:flex items-center px-3 py-2 rounded-lg hover:bg-gray-100 transition-all duration-300 hover:scale-105">
                <i class="fa fa-th-list mr-1"></i>分类
            </a>
            <button id="user-center-btn" class="p-2 rounded-full hover:bg-gray-100 transition-all relative">
                <i class="fa fa-user text-gray-600"></i>
                <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full animate-pulseSoft"></span>
            </button>
        </nav>
    </div>

    <!-- 移动端搜索框（默认隐藏） -->
    <div id="mobile-search" class="md:hidden px-4 pb-3 hidden animate-fadeInUp">
        <div class="relative">
            <input type="text" placeholder="搜索书名、作者或ISBN..."
                   class="w-full pl-10 pr-4 py-2 rounded-full border border-gray-200 search-focus">
            <i class="fa fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
        </div>
    </div>
</header>

<!-- 主内容区 -->
<main class="container mx-auto px-4 py-6">
    <!-- 轮播图区域 -->
    <section class="relative rounded-2xl overflow-hidden h-[200px] md:h-[300px] lg:h-[380px] mb-8 animate-fadeInUp" style="animation-delay: 0.4s;">
        <div class="carousel-container relative w-full h-full">
            <!-- 轮播图1 -->
            <div class="carousel-item active" style="animation-delay: 0s;">
                <img src="https://picsum.photos/id/24/1600/800" alt="校园图书共享活动" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-r from-black/60 to-transparent flex flex-col justify-center px-6 md:px-12">
                    <h2 class="text-xl md:text-3xl font-bold text-white mb-2">图书共享，知识传递</h2>
                    <p class="text-gray-100 text-sm md:text-base mb-4 max-w-md">闲置图书不浪费，让知识在校园内流动起来</p>
                    <button class="btn-primary w-fit animate-hoverPulse">
                        <i class="fa fa-plus-circle mr-1"></i> 发布我的图书
                    </button>
                </div>
            </div>
            <!-- 轮播图2 -->
            <div class="carousel-item" style="animation-delay: 5s;">
                <img src="https://picsum.photos/id/20/1600/800" alt="新学期教材共享" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-r from-black/60 to-transparent flex flex-col justify-center px-6 md:px-12">
                    <h2 class="text-xl md:text-3xl font-bold text-white mb-2">新学期教材共享</h2>
                    <p class="text-gray-100 text-sm md:text-base mb-4 max-w-md">学长学姐的优质教材，省钱又实用</p>
                    <a href="category.html?category=textbook" class="btn-secondary w-fit">
                        <i class="fa fa-book mr-1"></i> 浏览教材分类
                    </a>
                </div>
            </div>
            <!-- 轮播图3 -->
            <div class="carousel-item" style="animation-delay: 10s;">
                <img src="https://picsum.photos/id/180/1600/800" alt="热门小说推荐" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-r from-black/60 to-transparent flex flex-col justify-center px-6 md:px-12">
                    <h2 class="text-xl md:text-3xl font-bold text-white mb-2">热门小说限时借阅</h2>
                    <p class="text-gray-100 text-sm md:text-base mb-4 max-w-md">海量热门小说，免费借阅，读完即还</p>
                    <a href="category.html?category=novel" class="btn-primary w-fit">
                        <i class="fa fa-list-alt mr-1"></i> 查看热门小说
                    </a>
                </div>
            </div>
        </div>
        <!-- 轮播图指示器 -->
        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2">
            <button class="carousel-indicator w-2 h-2 rounded-full bg-white opacity-100" data-index="0"></button>
            <button class="carousel-indicator w-2 h-2 rounded-full bg-white opacity-50" data-index="1"></button>
            <button class="carousel-indicator w-2 h-2 rounded-full bg-white opacity-50" data-index="2"></button>
        </div>
    </section>

    <!-- 热门分类区域 -->
    <section class="mb-10 animate-fadeInUp" style="animation-delay: 0.5s;">
        <h2 class="text-xl font-bold mb-4 flex items-center">
            <i class="fa fa-th-large text-primary mr-2"></i>热门分类
        </h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <!-- 教材分类 -->
            <a href="category.html?category=textbook" class="category-card" style="animation-delay: 0.6s; opacity: 0; animation: fadeInUp 0.5s ease-out forwards;">
                <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mb-3">
                    <i class="fa fa-book text-primary text-xl"></i>
                </div>
                <h3 class="font-semibold mb-1">教材</h3>
                <p class="text-xs text-gray-500">8本图书</p>
            </a>
            <!-- 小说分类 -->
            <a href="category.html?category=novel" class="category-card" style="animation-delay: 0.7s; opacity: 0; animation: fadeInUp 0.5s ease-out forwards;">
                <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center mb-3">
                    <i class="fa fa-bookmark text-purple-600 text-xl"></i>
                </div>
                <h3 class="font-semibold mb-1">小说</h3>
                <p class="text-xs text-gray-500">6本图书</p>
            </a>
            <!-- 专业书籍分类 -->
            <a href="category.html?category=professional" class="category-card" style="animation-delay: 0.8s; opacity: 0; animation: fadeInUp 0.5s ease-out forwards;">
                <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mb-3">
                    <i class="fa fa-laptop text-green-600 text-xl"></i>
                </div>
                <h3 class="font-semibold mb-1">专业书籍</h3>
                <p class="text-xs text-gray-500">5本图书</p>
            </a>
            <!-- 科普分类 -->
            <a href="category.html?category=popular-science" class="category-card" style="animation-delay: 0.9s; opacity: 0; animation: fadeInUp 0.5s ease-out forwards;">
                <div class="w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center mb-3">
                    <i class="fa fa-flask text-orange-600 text-xl"></i>
                </div>
                <h3 class="font-semibold mb-1">科普</h3>
                <p class="text-xs text-gray-500">2本图书</p>
            </a>
        </div>
    </section>

    <!-- 推荐图书区域 -->
    <section class="mb-10 animate-fadeInUp" style="animation-delay: 1.0s;">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold flex items-center">
                <i class="fa fa-star text-accent mr-2"></i>推荐图书
            </h2>
            <a href="category.html" class="text-primary text-sm hover:underline transition-all duration-300 hover:scale-105">
                查看全部 <i class="fa fa-angle-right ml-1"></i>
            </a>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4" id="recommend-books">
            <!-- 推荐图书卡片动态生成 -->
        </div>
    </section>

    <!-- 最新上架区域 -->
    <section class="mb-10 animate-fadeInUp" style="animation-delay: 1.1s;">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold flex items-center">
                <i class="fa fa-clock-o text-primary mr-2"></i>最新上架
            </h2>
            <a href="category.html?sort=newest" class="text-primary text-sm hover:underline transition-all duration-300 hover:scale-105">
                查看全部 <i class="fa fa-angle-right ml-1"></i>
            </a>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4" id="newest-books">
            <!-- 最新上架图书卡片动态生成 -->
        </div>
    </section>

    <!-- 平台公告区域 -->
    <section class="mb-10 bg-white rounded-xl p-4 shadow-sm animate-fadeInUp" style="animation-delay: 1.2s;">
        <h2 class="text-xl font-bold mb-4 flex items-center">
            <i class="fa fa-bullhorn text-primary mr-2"></i>平台公告
        </h2>
        <div class="space-y-3">
            <a href="#" class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-all duration-300 hover:scale-[1.01]">
                <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-primary mr-3 flex-shrink-0">
                    <i class="fa fa-calendar"></i>
                </div>
                <div>
                    <h3 class="font-medium text-sm">2025年图书共享节活动启动</h3>
                    <p class="text-xs text-gray-500 mt-1">活动期间发布图书可获得双倍积分，借阅图书免押金，快来参与吧～</p>
                    <p class="text-xs text-gray-400 mt-1">2025-12-01</p>
                </div>
            </a>
            <a href="#" class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-all duration-300 hover:scale-[1.01]">
                <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center text-green-600 mr-3 flex-shrink-0">
                    <i class="fa fa-info"></i>
                </div>
                <div>
                    <h3 class="font-medium text-sm">借阅规则更新通知</h3>
                    <p class="text-xs text-gray-500 mt-1">新增预约功能，图书借阅期限延长至30天，支持续借一次（15天）</p>
                    <p class="text-xs text-gray-400 mt-1">2025-11-15</p>
                </div>
            </a>
            <a href="#" class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-all duration-300 hover:scale-[1.01]">
                <div class="w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 mr-3 flex-shrink-0">
                    <i class="fa fa-trophy"></i>
                </div>
                <div>
                    <h3 class="font-medium text-sm">图书共享达人评选活动</h3>
                    <p class="text-xs text-gray-500 mt-1">月度发布图书最多、借阅率最高的用户将获得校园文创礼品一份</p>
                    <p class="text-xs text-gray-400 mt-1">2025-10-30</p>
                </div>
            </a>
        </div>
    </section>

    <!-- 数据统计区域 -->
    <section class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-10 animate-fadeInUp" style="animation-delay: 1.3s;">
        <div class="bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center text-center card-hover">
            <div class="text-3xl font-bold text-primary mb-1">28</div>
            <div class="text-sm text-gray-500">共享图书总数</div>
        </div>
        <div class="bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center text-center card-hover">
            <div class="text-3xl font-bold text-secondary mb-1">156</div>
            <div class="text-sm text-gray-500">累计借阅次数</div>
        </div>
        <div class="bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center text-center card-hover">
            <div class="text-3xl font-bold text-accent mb-1">89</div>
            <div class="text-sm text-gray-500">注册用户数</div>
        </div>
        <div class="bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center text-center card-hover">
            <div class="text-3xl font-bold text-purple-600 mb-1">98%</div>
            <div class="text-sm text-gray-500">好评率</div>
        </div>
    </section>
</main>

<!-- 页脚（与分类页完全一致） -->
<footer class="bg-gray-800 text-white py-8 mt-10 animate-fadeInUp" style="animation-delay: 1.4s;">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="animate-fadeInUp" style="animation-delay: 1.5s;">
                <div class="flex items-center space-x-2 mb-4">
                    <i class="fa fa-book text-primary text-2xl"></i>
                    <h3 class="text-lg font-bold">校园图书共享</h3>
                </div>
                <p class="text-gray-400 text-sm">连接校内有闲置图书的学生与有借阅需求的学生，实现图书资源循环利用，营造校园阅读氛围。</p>
            </div>
            <div class="animate-fadeInUp" style="animation-delay: 1.6s;">
                <h4 class="font-bold mb-4">快速链接</h4>
                <ul class="space-y-2 text-gray-400 text-sm">
                    <li><a href="#" class="hover:text-white transition-colors duration-300 hover:translate-x-1">关于我们</a></li>
                    <li><a href="#" class="hover:text-white transition-colors duration-300 hover:translate-x-1">使用指南</a></li>
                    <li><a href="#" class="hover:text-white transition-colors duration-300 hover:translate-x-1">借阅规则</a></li>
                    <li><a href="#" class="hover:text-white transition-colors duration-300 hover:translate-x-1">常见问题</a></li>
                </ul>
            </div>
            <div class="animate-fadeInUp" style="animation-delay: 1.7s;">
                <h4 class="font-bold mb-4">联系我们</h4>
                <ul class="space-y-2 text-gray-400 text-sm">
                    <li class="flex items-center"><i class="fa fa-envelope-o mr-2"></i> support@bookshare.edu</li>
                    <li class="flex items-center"><i class="fa fa-phone mr-2"></i> 123-4567-8910</li>
                    <li class="flex items-center"><i class="fa fa-map-marker mr-2"></i> 图书馆302室</li>
                </ul>
                <div class="mt-4 flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition-all duration-300 transform hover:scale-125 hover:rotate-10"><i class="fa fa-weixin text-xl"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white transition-all duration-300 transform hover:scale-125 hover:rotate-10"><i class="fa fa-weibo text-xl"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white transition-all duration-300 transform hover:scale-125 hover:rotate-10"><i class="fa fa-qq text-xl"></i></a>
                </div>
            </div>
        </div>
        <div class="border-t border-gray-700 mt-6 pt-4 text-center text-gray-500 text-sm animate-fadeInUp" style="animation-delay: 1.8s;">
            &copy; 2025 校园图书共享平台 版权所有
        </div>
    </div>
</footer>

<!-- 个人中心侧边栏（与分类页完全一致） -->
<div id="user-center" class="fixed inset-y-0 right-0 w-full md:w-80 bg-white shadow-xl z-50 transform translate-x-full transition-transform duration-500 ease-in-out">
    <div class="h-full flex flex-col">
        <div class="p-6 border-b">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">个人中心</h2>
                <button id="close-user-center" class="text-gray-400 hover:text-gray-600 transition-colors hover:scale-110">
                    <i class="fa fa-times"></i>
                </button>
            </div>

            <div class="flex items-center animate-fadeInUp" style="animation-delay: 0.2s;">
                <img src="https://picsum.photos/id/91/100/100" alt="用户头像" class="w-16 h-16 rounded-full object-cover mr-4 transition-all duration-300 hover:scale-110 hover:shadow-md">
                <div>
                    <p class="font-medium" id="user-name">李华</p>
                    <p class="text-sm text-gray-600" id="user-info">软件学院 · 大二</p>
                    <button class="text-primary text-sm hover:underline mt-1 transition-all duration-300 hover:scale-105" id="edit-profile-btn">
                        编辑资料
                    </button>
                </div>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto p-4">
            <div class="mb-6">
                <h3 class="text-sm font-semibold text-gray-500 uppercase mb-3">我的功能</h3>
                <ul class="space-y-1">
                    <li>
                        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100 transition-all duration-300 hover:scale-[1.02] hover:translate-x-1">
                            <i class="fa fa-book text-primary w-6"></i>
                            <span class="ml-3">我的借阅</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100 transition-all duration-300 hover:scale-[1.02] hover:translate-x-1">
                            <i class="fa fa-bookmark text-primary w-6"></i>
                            <span class="ml-3">我的图书</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100 transition-all duration-300 hover:scale-[1.02] hover:translate-x-1">
                            <i class="fa fa-heart text-primary w-6"></i>
                            <span class="ml-3">我的收藏</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100 transition-all duration-300 hover:scale-[1.02] hover:translate-x-1">
                            <i class="fa fa-plus-circle text-primary w-6"></i>
                            <span class="ml-3">发布图书</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="mb-6">
                <h3 class="text-sm font-semibold text-gray-500 uppercase mb-3">消息通知</h3>
                <ul class="space-y-2">
                    <li class="bg-blue-50 rounded-lg p-3 transition-all duration-300 hover:shadow-md animate-fadeInUp" style="animation-delay: 0.3s;">
                        <div class="flex justify-between">
                            <p class="font-medium text-sm">张明接受了你的借阅申请</p>
                            <span class="text-xs text-gray-500">10分钟前</span>
                        </div>
                        <p class="text-xs text-gray-600 mt-1">《深入理解计算机系统》的借阅申请已被接受，请在约定时间前往取书</p>
                    </li>
                    <li class="bg-white rounded-lg p-3 border border-gray-100 transition-all duration-300 hover:shadow-md animate-fadeInUp" style="animation-delay: 0.4s;">
                        <div class="flex justify-between">
                            <p class="font-medium text-sm">新书上架提醒</p>
                            <span class="text-xs text-gray-500">1小时前</span>
                        </div>
                        <p class="text-xs text-gray-600 mt-1">你关注的分类有3本新书上架，快去看看吧</p>
                    </li>
                </ul>
            </div>
        </div>

        <div class="p-4 border-t">
            <button class="w-full flex items-center justify-center p-3 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 transition-all duration-300 hover:scale-[1.02]">
                <i class="fa fa-cog mr-2"></i>
                <span>设置</span>
            </button>
            <button class="w-full flex items-center justify-center p-3 rounded-lg border border-red-200 text-red-600 hover:bg-red-50 transition-all duration-300 hover:scale-[1.02] mt-3">
                <i class="fa fa-sign-out mr-2"></i>
                <span>退出登录</span>
            </button>
        </div>
    </div>
</div>

<!-- 编辑资料模态框 -->
<div id="edit-profile-modal" class="edit-profile-modal">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" id="edit-modal-backdrop"></div>
    <div class="modal-content">
        <div class="p-6 border-b">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">编辑个人资料</h2>
                <button id="close-edit-modal" class="text-gray-400 hover:text-gray-600 transition-colors hover:scale-110">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="flex items-center mb-8">
                <div class="relative">
                    <img src="https://picsum.photos/id/91/100/100" alt="用户头像" 
                         class="w-20 h-20 rounded-full object-cover border-4 border-white shadow-lg">
                    <button class="absolute bottom-0 right-0 w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center hover:bg-primary/90 transition-colors">
                        <i class="fa fa-camera text-sm"></i>
                    </button>
                </div>
                <div class="ml-6">
                    <h3 class="text-lg font-semibold">更新您的个人资料</h3>
                    <p class="text-gray-500 text-sm">完善资料可以让其他同学更好地了解您</p>
                </div>
            </div>
        </div>

        <div class="p-6">
            <form id="profile-form" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label class="form-label">姓名</label>
                        <input type="text" id="edit-name" class="form-input" value="李华" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">学号</label>
                        <input type="text" id="edit-student-id" class="form-input" value="2023045678" required>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label class="form-label">学院</label>
                        <select id="edit-college" class="form-select" required>
                            <option value="软件学院" selected>软件学院</option>
                            <option value="计算机学院">计算机学院</option>
                            <option value="数学学院">数学学院</option>
                            <option value="物理学院">物理学院</option>
                            <option value="文学院">文学院</option>
                            <option value="经济学院">经济学院</option>
                            <option value="法学院">法学院</option>
                            <option value="医学院">医学院</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">年级</label>
                        <select id="edit-grade" class="form-select" required>
                            <option value="大一">大一</option>
                            <option value="大二" selected>大二</option>
                            <option value="大三">大三</option>
                            <option value="大四">大四</option>
                            <option value="研究生">研究生</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label class="form-label">邮箱</label>
                        <input type="email" id="edit-email" class="form-input" value="lihua@example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">手机号</label>
                        <input type="tel" id="edit-phone" class="form-input" value="13800138000" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">个人简介</label>
                    <textarea id="edit-bio" class="form-textarea" rows="4" 
                              placeholder="介绍一下你自己，让其他同学更好地了解你...">热爱阅读的程序员，喜欢分享知识，目前在校园图书共享平台已发布5本图书，借阅过12次</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">阅读兴趣标签</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary" checked>
                            <span>小说</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary" checked>
                            <span>科技</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary">
                            <span>历史</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary" checked>
                            <span>计算机</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary">
                            <span>经济</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary">
                            <span>心理学</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary" checked>
                            <span>文学</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" class="mr-2 rounded text-primary focus:ring-primary">
                            <span>艺术</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">借阅偏好</label>
                    <div class="space-y-3">
                        <label class="flex items-center">
                            <input type="radio" name="borrow-preference" class="mr-3 text-primary focus:ring-primary" checked>
                            <span class="text-gray-700">允许其他同学随时借阅我的图书</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="borrow-preference" class="mr-3 text-primary focus:ring-primary">
                            <span class="text-gray-700">借阅前需要我确认</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="borrow-preference" class="mr-3 text-primary focus:ring-primary">
                            <span class="text-gray-700">仅限本学院同学借阅</span>
                        </label>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 pt-6 border-t">
                    <button type="button" id="cancel-edit" class="px-6 py-2.5 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition-all duration-300 hover:scale-105">
                        取消
                    </button>
                    <button type="submit" class="px-6 py-2.5 bg-primary text-white rounded-xl hover:bg-primary/90 transition-all duration-300 hover:scale-105 hover:shadow-lg">
                        保存更改
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- 背景遮罩（与分类页完全一致） -->
<div id="overlay" class="fixed inset-0 bg-black/30 z-40 hidden opacity-0 transition-opacity duration-500"></div>

<!-- 回到顶部按钮（与分类页完全一致） -->
<button id="back-to-top" class="back-to-top" onclick="scrollToTop()">
    <i class="fa fa-chevron-up"></i>
</button>

<!-- JavaScript 核心逻辑 -->
<script>
    // 图书数据源（与分类页一致）
    const allBooks = [
        // 教材类
        { id: 11, title: "线性代数及其应用", author: "吉尔伯特·斯特朗", cover: "https://picsum.photos/id/42/300/400", category: "教材", status: "可借阅", isbn: "9787111407010", publishDate: "2023-01-15", hotScore: 86 },
        { id: 12, title: "普通物理学", author: "程守洙", cover: "https://picsum.photos/id/190/300/400", category: "教材", status: "可借阅", isbn: "9787040439324", publishDate: "2023-02-20", hotScore: 78 },
        { id: 13, title: "高等数学（上册）", author: "同济大学数学系", cover: "https://picsum.photos/id/175/300/400", category: "教材", status: "可借阅", isbn: "9787040532734", publishDate: "2023-03-10", hotScore: 92 },
        { id: 14, title: "大学物理实验", author: "张三", cover: "https://picsum.photos/id/165/300/400", category: "教材", status: "已借出", isbn: "9787040498459", publishDate: "2023-04-05", hotScore: 65 },
        { id: 15, title: "C语言程序设计", author: "谭浩强", cover: "https://picsum.photos/id/155/300/400", category: "教材", status: "可借阅", isbn: "9787115546981", publishDate: "2023-05-12", hotScore: 89 },
        { id: 16, title: "概率论与数理统计", author: "茆诗松", cover: "https://picsum.photos/id/145/300/400", category: "教材", status: "可借阅", isbn: "9787040536944", publishDate: "2023-06-18", hotScore: 72 },
        { id: 17, title: "大学英语（第三版）", author: "李荫华", cover: "https://picsum.photos/id/135/300/400", category: "教材", status: "可借阅", isbn: "9787544663961", publishDate: "2023-07-22", hotScore: 81 },
        { id: 18, title: "数据结构", author: "严蔚敏", cover: "https://picsum.photos/id/125/300/400", category: "教材", status: "已借出", isbn: "9787111637814", publishDate: "2023-08-30", hotScore: 94 },

        // 小说类
        { id: 19, title: "百年孤独", author: "加西亚·马尔克斯", cover: "https://picsum.photos/id/20/300/400", category: "小说", status: "可借阅", isbn: "9787532755006", publishDate: "2023-01-05", hotScore: 98 },
        { id: 20, title: "三体", author: "刘慈欣", cover: "https://picsum.photos/id/180/300/400", category: "小说", status: "可借阅", isbn: "9787536692930", publishDate: "2023-02-18", hotScore: 96 },
        { id: 21, title: "活着", author: "余华", cover: "https://picsum.photos/id/240/300/400", category: "小说", status: "已借出", isbn: "9787506360243", publishDate: "2023-03-25", hotScore: 93 },
        { id: 22, title: "解忧杂货店", author: "东野圭吾", cover: "https://picsum.photos/id/230/300/400", category: "小说", status: "可借阅", isbn: "9787544270878", publishDate: "2023-04-10", hotScore: 88 },
        { id: 23, title: "追风筝的人", author: "卡勒德·胡赛尼", cover: "https://picsum.photos/id/220/300/400", category: "小说", status: "可借阅", isbn: "9787530208028", publishDate: "2023-05-15", hotScore: 85 },
        { id: 24, title: "围城", author: "钱钟书", cover: "https://picsum.photos/id/210/300/400", category: "小说", status: "可借阅", isbn: "9787020102999", publishDate: "2023-06-20", hotScore: 82 },

        // 专业书籍类
        { id: 25, title: "深入理解计算机系统", author: "兰德尔·布莱恩特", cover: "https://picsum.photos/id/24/300/400", category: "专业书籍", status: "可借阅", isbn: "9787111544937", publishDate: "2023-01-20", hotScore: 95 },
        { id: 26, title: "JavaScript高级程序设计", author: "尼古拉斯·泽卡斯", cover: "https://picsum.photos/id/21/300/400", category: "专业书籍", status: "可借阅", isbn: "9787115545381", publishDate: "2023-02-10", hotScore: 91 },
        { id: 27, title: "算法导论", author: "托马斯·科尔曼", cover: "https://picsum.photos/id/119/300/400", category: "专业书籍", status: "可借阅", isbn: "9787111407010", publishDate: "2023-03-05", hotScore: 89 },
        { id: 28, title: "数据库系统概念", author: "西尔伯沙茨", cover: "https://picsum.photos/id/109/300/400", category: "专业书籍", status: "已借出", isbn: "9787111544612", publishDate: "2023-04-18", hotScore: 84 },
        { id: 29, title: "机器学习", author: "周志华", cover: "https://picsum.photos/id/99/300/400", category: "专业书籍", status: "可借阅", isbn: "9787111540937", publishDate: "2023-05-22", hotScore: 97 },

        // 历史类
        { id: 30, title: "人类简史", author: "尤瓦尔·赫拉利", cover: "https://picsum.photos/id/36/300/400", category: "历史", status: "已借出", isbn: "9787508647357", publishDate: "2023-01-25", hotScore: 94 },
        { id: 31, title: "中国通史", author: "吕思勉", cover: "https://picsum.photos/id/46/300/400", category: "历史", status: "可借阅", isbn: "9787512660396", publishDate: "2023-03-12", hotScore: 87 },
        { id: 32, title: "明朝那些事儿", author: "当年明月", cover: "https://picsum.photos/id/56/300/400", category: "历史", status: "可借阅", isbn: "9787505719688", publishDate: "2023-05-30", hotScore: 92 },

        // 哲学类
        { id: 33, title: "苏菲的世界", author: "乔斯坦·贾德", cover: "https://picsum.photos/id/66/300/400", category: "哲学", status: "可借阅", isbn: "9787544259840", publishDate: "2023-02-08", hotScore: 83 },
        { id: 34, title: "西方哲学史", author: "伯特兰·罗素", cover: "https://picsum.photos/id/76/300/400", category: "哲学", status: "可借阅", isbn: "9787108029043", publishDate: "2023-04-25", hotScore: 79 },

        // 科普类
        { id: 35, title: "时间简史", author: "史蒂芬·霍金", cover: "https://picsum.photos/id/86/300/400", category: "科普", status: "可借阅", isbn: "9787535732309", publishDate: "2023-03-18", hotScore: 90 },
        { id: 36, title: "万物简史", author: "比尔·布莱森", cover: "https://picsum.photos/id/96/300/400", category: "科普", status: "已借出", isbn: "9787535745242", publishDate: "2023-06-15", hotScore: 81 },

        // 艺术类
        { id: 37, title: "艺术的故事", author: "贡布里希", cover: "https://picsum.photos/id/106/300/400", category: "艺术", status: "可借阅", isbn: "9787508087291", publishDate: "2023-01-30", hotScore: 77 },
        { id: 38, title: "设计心理学", author: "唐纳德·诺曼", cover: "https://picsum.photos/id/116/300/400", category: "艺术", status: "可借阅", isbn: "9787111558422", publishDate: "2023-05-08", hotScore: 84 }
    ];

    // 用户资料数据
    let userProfile = {
        name: "李华",
        studentId: "2023045678",
        college: "软件学院",
        grade: "大二",
        email: "lihua@example.com",
        phone: "13800138000",
        bio: "热爱阅读的程序员，喜欢分享知识，目前在校园图书共享平台已发布5本图书，借阅过12次",
        readingInterests: ["小说", "科技", "计算机", "文学"],
        borrowPreference: "allow-all"
    };

    // DOM元素获取
    const mobileSearchBtn = document.getElementById('mobile-search-btn');
    const mobileSearch = document.getElementById('mobile-search');
    const searchInput = document.getElementById('search-input');
    const searchIcon = document.getElementById('search-icon');
    const searchResults = document.getElementById('search-results');
    const userCenterBtn = document.getElementById('user-center-btn');
    const userCenter = document.getElementById('user-center');
    const closeUserCenter = document.getElementById('close-user-center');
    const overlay = document.getElementById('overlay');
    const backToTopBtn = document.getElementById('back-to-top');
    const header = document.getElementById('main-header');
    const recommendBooksContainer = document.getElementById('recommend-books');
    const newestBooksContainer = document.getElementById('newest-books');
    const carouselItems = document.querySelectorAll('.carousel-item');
    const carouselIndicators = document.querySelectorAll('.carousel-indicator');
    
    // 编辑资料相关DOM
    const editProfileBtn = document.getElementById('edit-profile-btn');
    const editProfileModal = document.getElementById('edit-profile-modal');
    const closeEditModal = document.getElementById('close-edit-modal');
    const cancelEdit = document.getElementById('cancel-edit');
    const editModalBackdrop = document.getElementById('edit-modal-backdrop');
    const profileForm = document.getElementById('profile-form');

    // 1. 移动端搜索框切换（与分类页一致）
    mobileSearchBtn.addEventListener('click', () => {
        mobileSearch.classList.toggle('hidden');
        if (!mobileSearch.classList.contains('hidden')) {
            mobileSearch.querySelector('input').focus();
        }
    });

    // 搜索框焦点样式（与分类页一致）
    searchInput.addEventListener('focus', () => {
        searchIcon.classList.add('text-primary');
    });
    searchInput.addEventListener('blur', () => {
        if (!searchInput.value.trim()) {
            searchIcon.classList.remove('text-primary');
        }
    });

    // 2. 回到顶部功能（与分类页一致）
    function scrollToTop() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }

    // 滚动监听（与分类页一致）
    window.addEventListener('scroll', () => {
        // 回到顶部按钮显示/隐藏
        if (window.pageYOffset > 300) {
            backToTopBtn.classList.add('show');
        } else {
            backToTopBtn.classList.remove('show');
        }

        // 导航栏滚动效果
        if (window.pageYOffset > 50) {
            header.classList.add('shadow-md', 'py-2');
            header.classList.remove('shadow-sm', 'py-3');
        } else {
            header.classList.remove('shadow-md', 'py-2');
            header.classList.add('shadow-sm', 'py-3');
        }
    });

    // 3. 轮播图功能
    let currentCarouselIndex = 0;
    let carouselInterval;

    // 初始化轮播图
    function initCarousel() {
        // 自动轮播
        carouselInterval = setInterval(nextCarousel, 5000);

        // 指示器点击事件
        carouselIndicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => {
                clearInterval(carouselInterval);
                setCarouselIndex(index);
                carouselInterval = setInterval(nextCarousel, 5000);
            });
        });
    }

    // 切换到下一张轮播图
    function nextCarousel() {
        setCarouselIndex((currentCarouselIndex + 1) % carouselItems.length);
    }

    // 设置轮播图索引
    function setCarouselIndex(index) {
        // 移除所有active状态
        carouselItems.forEach(item => item.classList.remove('active'));
        carouselIndicators.forEach(indicator => indicator.classList.remove('opacity-100'));
        carouselIndicators.forEach(indicator => indicator.classList.add('opacity-50'));

        // 设置当前active状态
        currentCarouselIndex = index;
        carouselItems[currentCarouselIndex].classList.add('active');
        carouselIndicators[currentCarouselIndex].classList.add('opacity-100');
        carouselIndicators[currentCarouselIndex].classList.remove('opacity-50');
    }

    // 4. 渲染推荐图书（按热门分数排序）
    function renderRecommendBooks() {
        // 按热门分数降序排序，取前10本
        const recommendBooks = [...allBooks]
            .sort((a, b) => b.hotScore - a.hotScore)
            .slice(0, 10);

        let html = '';
        recommendBooks.forEach((book, index) => {
            // 检查收藏状态
            const favorites = JSON.parse(localStorage.getItem('bookFavorites') || '[]');
            const isFavorite = favorites.includes(book.id);

            // 入场动画延迟
            const delay = 0.1 * index + 1.2;

            html += `
                <div class="bg-white rounded-xl overflow-hidden shadow-sm card-hover book-card relative" data-id="${book.id}" style="animation-delay: ${delay}s; opacity: 0; animation: fadeInUp 0.5s ease-out forwards;">
                    <div class="relative overflow-hidden">
                        <img src="${book.cover}" alt="${book.title}" class="w-full h-40 sm:h-48 object-cover transition-transform duration-500 hover:scale-110">
                        <span class="absolute top-2 right-2 bg-${book.status === '可借阅' ? 'secondary' : 'gray-500'} text-white text-xs px-2 py-1 rounded-full transform transition-transform duration-300 hover:scale-110">${book.status}</span>
                        <!-- 快速借阅按钮 -->
                        <button class="quick-borrow flex items-center ${book.status !== '可借阅' ? 'opacity-50 cursor-not-allowed' : ''}">
                            <i class="fa fa-bookmark-o mr-1"></i> ${book.status === '可借阅' ? '快速借阅' : '已借出'}
                        </button>
                    </div>
                    <div class="p-3">
                        <h3 class="font-semibold text-sm truncate transition-all duration-300 hover:text-primary">${book.title}</h3>
                        <p class="text-gray-500 text-xs mt-1">${book.author}</p>
                        <div class="flex justify-between items-center mt-2">
                            <span class="text-xs bg-blue-50 text-primary px-2 py-0.5 rounded-full transition-all duration-300 hover:bg-primary hover:text-white">${book.category}</span>
                            <i class="fa ${isFavorite ? 'fa-heart text-red-500' : 'fa-heart-o text-gray-300 hover:text-red-500'} cursor-pointer transition-all duration-300 hover:scale-125 favorite-btn" data-id="${book.id}"></i>
                        </div>
                    </div>
                </div>
            `;
        });

        recommendBooksContainer.innerHTML = html;
    }

    // 5. 渲染最新上架图书（按发布日期排序）
    function renderNewestBooks() {
        // 按发布日期降序排序，取前10本
        const newestBooks = [...allBooks]
            .sort((a, b) => new Date(b.publishDate) - new Date(a.publishDate))
            .slice(0, 10);

        let html = '';
        newestBooks.forEach((book, index) => {
            // 检查收藏状态
            const favorites = JSON.parse(localStorage.getItem('bookFavorites') || '[]');
            const isFavorite = favorites.includes(book.id);

            // 入场动画延迟
            const delay = 0.1 * index + 1.3;

            html += `
                <div class="bg-white rounded-xl overflow-hidden shadow-sm card-hover book-card relative" data-id="${book.id}" style="animation-delay: ${delay}s; opacity: 0; animation: fadeInUp 0.5s ease-out forwards;">
                    <div class="relative overflow-hidden">
                        <img src="${book.cover}" alt="${book.title}" class="w-full h-40 sm:h-48 object-cover transition-transform duration-500 hover:scale-110">
                        <span class="absolute top-2 right-2 bg-${book.status === '可借阅' ? 'secondary' : 'gray-500'} text-white text-xs px-2 py-1 rounded-full transform transition-transform duration-300 hover:scale-110">${book.status}</span>
                        <!-- 快速借阅按钮 -->
                        <button class="quick-borrow flex items-center ${book.status !== '可借阅' ? 'opacity-50 cursor-not-allowed' : ''}">
                            <i class="fa fa-bookmark-o mr-1"></i> ${book.status === '可借阅' ? '快速借阅' : '已借出'}
                        </button>
                    </div>
                    <div class="p-3">
                        <h3 class="font-semibold text-sm truncate transition-all duration-300 hover:text-primary">${book.title}</h3>
                        <p class="text-gray-500 text-xs mt-1">${book.author}</p>
                        <div class="flex justify-between items-center mt-2">
                            <span class="text-xs bg-blue-50 text-primary px-2 py-0.5 rounded-full transition-all duration-300 hover:bg-primary hover:text-white">${book.category}</span>
                            <i class="fa ${isFavorite ? 'fa-heart text-red-500' : 'fa-heart-o text-gray-300 hover:text-red-500'} cursor-pointer transition-all duration-300 hover:scale-125 favorite-btn" data-id="${book.id}"></i>
                        </div>
                    </div>
                </div>
            `;
        });

        newestBooksContainer.innerHTML = html;
    }

    // 6. 绑定图书相关事件（与分类页一致）
    function bindBookEvents() {
        // 委托事件，监听所有图书卡片点击
        document.addEventListener('click', (e) => {
            const bookCard = e.target.closest('.book-card');
            const favoriteBtn = e.target.closest('.favorite-btn');
            const quickBorrowBtn = e.target.closest('.quick-borrow');

            // 图书卡片点击（排除收藏和借阅按钮）
            if (bookCard && !favoriteBtn && !quickBorrowBtn) {
                const bookId = parseInt(bookCard.dataset.id);
                const book = allBooks.find(b => b.id === bookId);

                // 点击反馈
                bookCard.classList.add('scale-[0.98]');
                setTimeout(() => {
                    bookCard.classList.remove('scale-[0.98]');
                    alert(`图书详情：\n书名：${book.title}\n作者：${book.author}\n分类：${book.category}\n状态：${book.status}\nISBN：${book.isbn}`);
                }, 150);
            }

            // 收藏按钮点击
            if (favoriteBtn) {
                e.stopPropagation();
                const bookId = parseInt(favoriteBtn.dataset.id);
                const book = allBooks.find(b => b.id === bookId);
                let favorites = JSON.parse(localStorage.getItem('bookFavorites') || '[]');

                // 收藏动画
                favoriteBtn.classList.add('scale-150');
                setTimeout(() => {
                    favoriteBtn.classList.remove('scale-150');
                }, 200);

                if (favorites.includes(bookId)) {
                    // 取消收藏
                    favorites = favorites.filter(id => id !== bookId);
                    favoriteBtn.classList.remove('fa-heart', 'text-red-500');
                    favoriteBtn.classList.add('fa-heart-o', 'text-gray-300');
                    alert(`已取消收藏《${book.title}》`);
                } else {
                    // 添加收藏
                    favorites.push(bookId);
                    favoriteBtn.classList.remove('fa-heart-o', 'text-gray-300');
                    favoriteBtn.classList.add('fa-heart', 'text-red-500');
                    alert(`已收藏《${book.title}》到我的收藏夹`);
                }

                localStorage.setItem('bookFavorites', JSON.stringify(favorites));
            }

            // 快速借阅按钮点击
            if (quickBorrowBtn) {
                e.stopPropagation();
                const bookCard = quickBorrowBtn.closest('.book-card');
                const bookId = parseInt(bookCard.dataset.id);
                const book = allBooks.find(b => b.id === bookId);

                if (book.status === '可借阅') {
                    quickBorrowBtn.classList.add('scale-95');
                    setTimeout(() => {
                        quickBorrowBtn.classList.remove('scale-95');
                        alert(`成功申请借阅《${book.title}》\n请等待图书主人确认，确认后会通知你取书地点和时间`);
                    }, 150);
                } else {
                    alert(`《${book.title}》当前已借出，可加入预约队列，图书归还后会第一时间通知你`);
                }
            }
        });
    }

    // 7. 搜索功能（与分类页一致）
    searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase().trim();

        if (query.length < 1) {
            searchResults.classList.add('hidden');
            return;
        }

        // 搜索匹配
        const results = allBooks.filter(book =>
            book.title.toLowerCase().includes(query) ||
            book.author.toLowerCase().includes(query) ||
            book.isbn.includes(query) ||
            book.category.toLowerCase().includes(query)
        );

        // 显示搜索结果
        if (results.length === 0) {
            searchResults.innerHTML = `
                <div class="px-4 py-3 text-gray-500 text-sm">
                    没有找到匹配的图书
                </div>
            `;
            searchResults.classList.remove('hidden');
            return;
        }

        // 生成搜索结果下拉框
        let resultsHTML = '';
        results.slice(0, 5).forEach(book => {
            resultsHTML += `
                <div class="px-4 py-3 hover:bg-gray-50 transition-colors cursor-pointer book-result" data-id="${book.id}">
                    <div class="font-medium">${highlightMatch(book.title, query)}</div>
                    <div class="text-sm text-gray-500">${book.author} · ${book.category}</div>
                </div>
            `;
        });

        searchResults.innerHTML = resultsHTML;
        searchResults.classList.remove('hidden');

        // 搜索结果点击
        document.querySelectorAll('.book-result').forEach(result => {
            result.addEventListener('click', () => {
                const bookId = parseInt(result.dataset.id);
                const book = allBooks.find(b => b.id === bookId);

                result.classList.add('bg-gray-100');
                setTimeout(() => {
                    result.classList.remove('bg-gray-100');
                    alert(`图书详情：\n书名：${book.title}\n作者：${book.author}\n分类：${book.category}\n状态：${book.status}\nISBN：${book.isbn}`);
                    searchResults.classList.add('hidden');
                    searchInput.value = '';
                }, 150);
            });
        });
    });

    // 点击页面其他区域关闭搜索结果（与分类页一致）
    document.addEventListener('click', (e) => {
        if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
            searchResults.classList.add('hidden');
        }
    });

    // 高亮搜索匹配文本（与分类页一致）
    function highlightMatch(text, query) {
        const regex = new RegExp(`(${query})`, 'gi');
        return text.replace(regex, '<span class="bg-yellow-200">$1</span>');
    }

    // 8. 个人中心开关（与分类页一致）
    userCenterBtn.addEventListener('click', () => {
        userCenter.classList.remove('translate-x-full');
        overlay.classList.remove('hidden');
        setTimeout(() => {
            overlay.classList.add('opacity-100');
        }, 10);
        document.body.style.overflow = 'hidden';
    });

    function closeUserCenterSidebar() {
        userCenter.classList.add('translate-x-full');
        overlay.classList.remove('opacity-100');
        setTimeout(() => {
            overlay.classList.add('hidden');
            document.body.style.overflow = '';
        }, 300);
    }

    closeUserCenter.addEventListener('click', closeUserCenterSidebar);
    overlay.addEventListener('click', closeUserCenterSidebar);

    // 9. 编辑资料功能
    editProfileBtn.addEventListener('click', () => {
        // 关闭个人中心侧边栏
        closeUserCenterSidebar();
        
        // 延迟显示编辑模态框，让侧边栏有动画时间关闭
        setTimeout(() => {
            // 填充表单数据
            fillProfileForm();
            
            // 显示编辑模态框
            editProfileModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }, 300);
    });

    // 填充表单数据
    function fillProfileForm() {
        document.getElementById('edit-name').value = userProfile.name;
        document.getElementById('edit-student-id').value = userProfile.studentId;
        document.getElementById('edit-college').value = userProfile.college;
        document.getElementById('edit-grade').value = userProfile.grade;
        document.getElementById('edit-email').value = userProfile.email;
        document.getElementById('edit-phone').value = userProfile.phone;
        document.getElementById('edit-bio').value = userProfile.bio;
        
        // 设置阅读兴趣
        const checkboxes = document.querySelectorAll('.checkbox-group input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            const label = checkbox.closest('.checkbox-label');
            const interest = label.querySelector('span').textContent;
            checkbox.checked = userProfile.readingInterests.includes(interest);
        });
        
        // 设置借阅偏好
        const radios = document.querySelectorAll('input[name="borrow-preference"]');
        radios.forEach(radio => {
            if (radio.nextElementSibling.textContent.includes('允许其他同学随时借阅')) {
                radio.checked = userProfile.borrowPreference === 'allow-all';
            } else if (radio.nextElementSibling.textContent.includes('借阅前需要我确认')) {
                radio.checked = userProfile.borrowPreference === 'need-confirm';
            } else if (radio.nextElementSibling.textContent.includes('仅限本学院同学')) {
                radio.checked = userProfile.borrowPreference === 'same-college';
            }
        });
    }

    // 关闭编辑模态框
    function closeEditProfileModal() {
        editProfileModal.classList.remove('show');
        document.body.style.overflow = '';
    }

    closeEditModal.addEventListener('click', closeEditProfileModal);
    cancelEdit.addEventListener('click', closeEditProfileModal);
    editModalBackdrop.addEventListener('click', closeEditProfileModal);

    // 表单提交处理
    profileForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        // 收集表单数据
        const formData = {
            name: document.getElementById('edit-name').value,
            studentId: document.getElementById('edit-student-id').value,
            college: document.getElementById('edit-college').value,
            grade: document.getElementById('edit-grade').value,
            email: document.getElementById('edit-email').value,
            phone: document.getElementById('edit-phone').value,
            bio: document.getElementById('edit-bio').value,
            readingInterests: [],
            borrowPreference: ''
        };
        
        // 收集阅读兴趣
        const checkedInterests = document.querySelectorAll('.checkbox-group input[type="checkbox"]:checked');
        checkedInterests.forEach(checkbox => {
            const label = checkbox.closest('.checkbox-label');
            formData.readingInterests.push(label.querySelector('span').textContent);
        });
        
        // 收集借阅偏好
        const selectedPreference = document.querySelector('input[name="borrow-preference"]:checked');
        if (selectedPreference.nextElementSibling.textContent.includes('允许其他同学随时借阅')) {
            formData.borrowPreference = 'allow-all';
        } else if (selectedPreference.nextElementSibling.textContent.includes('借阅前需要我确认')) {
            formData.borrowPreference = 'need-confirm';
        } else if (selectedPreference.nextElementSibling.textContent.includes('仅限本学院同学')) {
            formData.borrowPreference = 'same-college';
        }
        
        // 更新用户资料
        userProfile = formData;
        
        // 更新显示
        document.getElementById('user-name').textContent = userProfile.name;
        document.getElementById('user-info').textContent = `${userProfile.college} · ${userProfile.grade}`;
        
        // 保存到localStorage
        localStorage.setItem('userProfile', JSON.stringify(userProfile));
        
        // 显示成功消息
        showNotification('个人资料已成功更新！', 'success');
        
        // 关闭模态框
        closeEditProfileModal();
    });

    // 显示通知
    function showNotification(message, type = 'success') {
        // 移除现有的通知
        const existingNotification = document.querySelector('.notification');
        if (existingNotification) {
            existingNotification.remove();
        }
        
        // 创建通知元素
        const notification = document.createElement('div');
        notification.className = `notification fixed top-4 right-4 z-[100] px-6 py-3 rounded-xl shadow-lg animate-fadeInUp ${
            type === 'success' ? 'bg-green-500' : 
            type === 'error' ? 'bg-red-500' : 'bg-blue-500'
        } text-white`;
        
        notification.innerHTML = `
            <div class="flex items-center">
                <i class="fa ${type === 'success' ? 'fa-check-circle' : 'fa-info-circle'} mr-2"></i>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // 3秒后自动移除
        setTimeout(() => {
            notification.classList.add('opacity-0', 'translate-y-2');
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 3000);
    }

    // 页面加载初始化
    window.addEventListener('load', () => {
        // 加载保存的用户资料
        const savedProfile = localStorage.getItem('userProfile');
        if (savedProfile) {
            userProfile = JSON.parse(savedProfile);
            document.getElementById('user-name').textContent = userProfile.name;
            document.getElementById('user-info').textContent = `${userProfile.college} · ${userProfile.grade}`;
        }
        
        // 初始化轮播图
        initCarousel();

        // 渲染推荐图书
        renderRecommendBooks();

        // 渲染最新上架图书
        renderNewestBooks();

        // 绑定图书事件
        bindBookEvents();
    });
</script>
</body>
</html>